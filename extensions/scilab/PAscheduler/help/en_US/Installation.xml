<?xml version="1.0" encoding="ISO-8859-1"?>
<refentry version="5.0-subset Scilab" xml:id="Installation" xml:lang="en"
          xmlns="http://docbook.org/ns/docbook"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:svg="http://www.w3.org/2000/svg"
          xmlns:ns3="http://www.w3.org/1999/xhtml"
          xmlns:mml="http://www.w3.org/1998/Math/MathML"
          xmlns:db="http://docbook.org/ns/docbook">
    <info>
        <pubdate>$LastChangedDate: 2011-07-20 18:41:39 +0100 (mer., 20 july 2011)$</pubdate>
    </info>
    <refnamediv>
        <refname>Installation</refname>

        <refpurpose>Installation of the ProActive Toolbox</refpurpose>

    </refnamediv>

    <refsection>
        <title>Introduction</title>


        <para>A typical deployment of ProActive Scheduler with Scilab can be seen on the diagram below:</para>
        <para>
            <inlinemediaobject>
                <imageobject>
                    <imagedata fileref="SchedulerScilab.png"/>
                </imageobject>
            </inlinemediaobject>
        </para>
        <itemizedlist>
            <listitem>
                <para>The local Scilab session will connect to the ProActive Scheduler.
                </para>
            </listitem>
            <listitem>
                <para>The local user will submit a function "foo" to call with a set of parameters.
                </para>
            </listitem>
            <listitem>
                <para>The Scheduler will select among all its resources, those suited to the job.
                </para>
            </listitem>
            <listitem>
                <para>A Scilab engine will be started on each selected resource.
                </para>
            </listitem>
            <listitem>
                <para>Each foo(k) will be executed on remote engine.
                </para>
            </listitem>
            <listitem>
                <para>Results will be forwarded back to the use
                </para>
            </listitem>
        </itemizedlist>
    </refsection>
    <refsection>
        <title>Downloading and Installing ProActive Toolbox</title>
        <para>ProActive Scheduler Toolbox can be downloaded from :
            <emphasis>http://www.activeeon.com/community-downloads</emphasis>
            The package which must be downloaded is called ProActive Scheduling
            After downloading the package unzip it in a directory e.g. D:\Scheduling
            IMPORTANT: According to your deployment infrastructure, ProActive Scheduler must be installed on :
        </para>
        <itemizedlist>
            <listitem>
                <para>The host which will launch the Scheduler.
                </para>
            </listitem>
            <listitem>
                <para>Each worker host used by the Scheduler.
                </para>
            </listitem>
            <listitem>
                <para>Each client host which will connect to the Scheduler to submit Scilab functions (Any of the ProActive Scheduler client packages can be used instead of the ProActive Scheduler server package for these machines).
                </para>
            </listitem>
        </itemizedlist>
    </refsection>
    <refsection>
        <title>Configuration of Remote Workers for Scilab</title>
        <para>On each worker host that will be used to compute remotely scilab functions, a specific configuration file must be written to tell the scheduler where to find a scilab installation. The configuration file is called ScilabConfiguration.xml, and is located in the folder SCHEDULING/extensions/scilab/config/worker for each Worker Hosts.</para>
        <para>By default, the SCHEDULING/extensions/scilab/config/worker folder only contains two template files one for Linux and one for Windows called ScilabConfigurationTemplateUnix.xml and ScilabConfigurationTemplateWindows.xml, one of this template must be edited and renamed into ScilabConfiguration.xml to setup the configuration for the current Worker Host. The same operation must be done on each machine (unless you use a network shared directory).
</para><para>For example, here is ScilabConfigurationTemplateWindows.xml :
        </para>
        <programlisting><![CDATA[<ScilabInstallations>
    <installation>
        <version>5.3.0</version> <!-- Scilab version (must be at least 5.3.0) -->
        <home>c:\Program Files\scilab-5.3.0</home> <!-- Scilab installation directory -->
        <libdir>bin</libdir>  <!-- Relative path to scilab libraries (generally bin on windows) -->
        <!-- <tpdir>lib/thirdparty</tpdir>-->  <!-- Relative path to scilab third party libraries (empty on windows) -->
        <!-- <scidir>share/scilab</scidir>-->  <!-- Relative path to scilab SCI directory (empty on windows) -->
        <bindir>bin</bindir>
        <command>Scilex.exe</command>
    </installation>
</ScilabInstallations>]]></programlisting>
        <para>Here is an explanation of tags used by this file:</para>
        <itemizedlist>
            <listitem>
                <para><emphasis>version:</emphasis> the Scilab version installed in numeric format.
                </para>
            </listitem>
            <listitem>
                <para><emphasis>home:</emphasis> full path to matlab home directory.
                </para>
            </listitem>
            <listitem>
                <para><emphasis>libdir:</emphasis> relative path (from homedir) to scilab dlls or so files.
                </para>
            </listitem>
            <listitem>
                <para><emphasis>bindir:</emphasis> relative path (from homedir) to scilab executable.
                </para>
            </listitem>
            <listitem>
                <para><emphasis>command:</emphasis> scilab executable name.
                </para>
            </listitem>
        </itemizedlist>
    </refsection>
    <refsection>
        <title>Setting up the java.policy file</title>
        <para>On each client host that will connect to the Scheduler to submit tasks, it is mandatory to add a specific configuration file for Java called the Java Policy file. This file is meant to define the security settings of a given Java Virtual Machine. This configuration can either be:</para>
        <itemizedlist>
            <listitem>
                <para>Specific to a given <emphasis>scilab installation</emphasis> (but common for all users on this machine).
                </para>
            </listitem>
            <listitem>
                <para>Specific to a given <emphasis>user</emphasis>, but common to every scilab installations of this machine (and also all other Java programs).
                </para>
            </listitem>
        </itemizedlist>
        <refsection><title>Scilab specific configuration</title>
            <para>In order to do the first type of configuration, one needs to have write access to Scilab's installation directory (requires administrator privilege). First a file called scilab.java.policy must be created in any directory (for example DIRPOLICY).</para>
            <para>The scilab.java.policy file must contain the following:</para>
            <programlisting><![CDATA[grant {
  permission java.security.AllPermission;
};]]></programlisting>
            <para>Finally, the file SCILAB/share/scilab/etc/jvm_options.xml needs to be edited and the following lines added between the main tags "jvm_options":</para>
            <programlisting><![CDATA[<option value="-Djava.security.manager"/>
<option value="-Djava.security.policy=/path/to/DIRPOLICY/scilab.java.policy"/>
]]></programlisting>
            <para>If the configuration has not been done properly, a call to PAconnect will result in displaying an error message containing the following Exception:
java.security.AccessControlException: access denied (java.util.PropertyPermission org.mortbay.io.nio.JVMBUG_THRESHHOLD read)

Recheck your configuration if this message appear.</para>
            </refsection>
            <refsection><title>User specific configuration</title>
            <para>The second type of java policy configuration is simpler to do than the first one, but it will apply to every Java program started by this user on your machine, including Java applets. Accordingly, this set up should be done with care.
In order to do the second configuration, go to the <emphasis>HOME</emphasis> directory of the user that will use the toolbox.</para>
             <para>In this HOME directory, create a file called .java.policy (notice the first dot in the file name), which will contain the same text as the scilab.java.policy file from the first method. That's it! Again, if the configuration is not done properly the same exception will appear when trying to connect to the Scheduler.</para>

            </refsection>

    </refsection>

    <refsection>
        <title>See Also</title>
        <simplelist type="inline">
            <member>
                <link linkend="Introduction">Introduction</link>
            </member>
            <member>
                <link linkend="PAsolve">PAsolve</link>
            </member>
             <member>
                <link linkend="PAconnect">PAconnect</link>
            </member>
        </simplelist>
    </refsection>

    <refsection>
        <title>Authors</title>

        <simplelist type="vert">
            <member>The ProActive Team, Fabien Viale</member>
        </simplelist>
    </refsection>
</refentry>