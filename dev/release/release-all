. dev/release/common

function build() {
	# Replace version tag in main java file
	sed -i "s/{rm-version-main}/$VERSION/" src/scheduler/src/org/ow2/proactive/scheduler/common/Main.java
	sed -i "s/{scheduler-version-main}/$VERSION/" src/resource-manager/src/org/ow2/proactive/resourcemanager/common/Main.java

	echo "********************** Building the scheduler ************************"
	cd compile || warn_and_exit "Cannot move in compile"
	./build clean
	./build -Dversion="${VERSION}" deploy.all
	./build -Dversion="${VERSION}" doc.Scheduler.manualPdf

	generate_credential
}

init_env ProActiveScheduler $*
copy_to_tmp
build_and_clean
clean_repository
replace_version
build_archive
