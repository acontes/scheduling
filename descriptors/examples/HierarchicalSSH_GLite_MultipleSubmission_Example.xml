<?xml version="1.0" encoding="UTF-8"?>
<ProActiveDescriptor
	xmlns="urn:proactive:deployment:3.3"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="urn:proactive:deployment:3.3 http://www-sop.inria.fr/oasis/ProActive/schemas/deployment/3.3/deployment.xsd">
    <variables>
        <descriptorVariable name="PROACTIVE_HOME" value="/home/user/ProActive"/> <!--CHANGE ME!!!! -->
        <descriptorVariable name="REMOTE_HOME" value="/users/dsksi/emathias"/> <!--CHANGE ME!!!! -->
        <descriptorVariable name="JAVA_HOME" 
			value="/usr/java/j2sdk1.4.2_08" /><!-- Path of the remote JVM , CHANGE ME!!!! -->
        
    </variables>
    <componentDefinition>
        <virtualNodesDefinition>
            <virtualNode name="plugtest"/>
        </virtualNodesDefinition>
    </componentDefinition>
    
    <deployment>
        <mapping>
            <map virtualNode="plugtest">
                <jvmSet>
                    <vmName value="JvmLAL"/>
                </jvmSet>
            </map>
        </mapping>
        <jvms>
            <jvm name="JvmLAL">
                <creation>
                    <processReference refid="sshHierarchical"/>
                </creation>
            </jvm>           
        </jvms>
    </deployment>
    
    <infrastructure>
        <processes>
            <processDefinition id="ceJVM">
                <jvmProcess class="org.objectweb.proactive.core.process.JVMNodeProcess">
                    <classpath>
	                                                                    <absolutePath value="${PROACTIVE_HOME}/dist/ProActive/ProActive.jar"/>
                                                <absolutePath value="${PROACTIVE_HOME}/lib/bouncycastle.jar"/>

                                                <absolutePath value="${PROACTIVE_HOME}/lib/fractal.jar"/>
                                                <absolutePath value="${PROACTIVE_HOME}/lib/ganymed-ssh2-build210.jar"/>
                                                <absolutePath value="${PROACTIVE_HOME}/lib/javassist.jar"/>
                                                <absolutePath value="${PROACTIVE_HOME}/lib/log4j.jar"/>
                                                <absolutePath value="${PROACTIVE_HOME}/lib/xercesImpl.jar"/>

                    </classpath>
                    <policyFile>
                        <absolutePath value="proactive.java.policy"/>
                    </policyFile>
                    <log4jpropertiesFile>
                        <absolutePath value="proactive-log4j"/>
                    </log4jpropertiesFile>
                    <!--<jvmParameters>
                        <parameter value="-Dproactive.communication.protocol=rmissh"/>
                    </jvmParameters>-->
                </jvmProcess>                
            </processDefinition>

			<processDefinition id="uiJVM">
                <jvmProcess class="org.objectweb.proactive.core.process.JVMNodeProcess">
                    <classpath>
	                                                                    <absolutePath value="${PROACTIVE_HOME}/dist/ProActive/ProActive.jar"/>
                                                <absolutePath value="${PROACTIVE_HOME}/lib/bouncycastle.jar"/>

                                                <absolutePath value="${PROACTIVE_HOME}/lib/fractal.jar"/>
                                                <absolutePath value="${PROACTIVE_HOME}/lib/ganymed-ssh2-build210.jar"/>
                                                <absolutePath value="${PROACTIVE_HOME}/lib/javassist.jar"/>
                                                <absolutePath value="${PROACTIVE_HOME}/lib/log4j.jar"/>
                                                <absolutePath value="${PROACTIVE_HOME}/lib/xercesImpl.jar"/>

                    </classpath>
					<javaPath>
				      <absolutePath  value="${JAVA_HOME}/bin/java"/> 
				    </javaPath>
                    <policyFile>
                        <absolutePath value="${PROACTIVE_HOME}/scripts/proactive.java.policy"/>
                    </policyFile>
                    <log4jpropertiesFile>
                        <absolutePath value="${PROACTIVE_HOME}/scripts/proactive-log4j"/>
                    </log4jpropertiesFile>
                    <jvmParameters>
                        <parameter value="-Dproactive.communication.protocol=rmissh"/>
                    </jvmParameters>
                </jvmProcess>
            </processDefinition>

			
			 <processDefinition id="frontendJVM">
                <jvmProcess class="org.objectweb.proactive.core.process.JVMNodeProcess">
                    <extendedJvm refid="uiJVM"/>
                    <jvmParameters>
                        <parameter value="-Dproactive.communication.protocol=rmissh"/>
                        <parameter value="-Dproactive.rmi.port=2030"/>
                    </jvmParameters>
                </jvmProcess>
            </processDefinition>

            
            <processDefinition id="gLiteProcess"> 
                <gLiteProcess class="org.objectweb.proactive.core.process.glite.GLiteProcess" virtualOrganisation="proactive"  executable="/usr/java/jdk1.5.0_08/bin/java" JDLFileName="job.jdl" Type="job" stdError="error.log" stdOutput="stdout.log" jobType="mpich" nodeNumber="32" retryCount="3">
                    <processReference refid="ceJVM"/> 
	                <requirements>other.GlueCEUniqueID == "grid10.lal.in2p3.fr:2119/jobmanager-pbs-sdj"</requirements>
                    <rank>-other.GlueCEStateEstimatedResponseTime</rank>
                    <gLiteOptions>
                        <configFile>
                            <absolutePath value="${PROACTIVE_HOME}/scripts/unix/proactiveVO/proactiveVO.conf"/>
                        </configFile>
                        <JDLFilePath>
                            <absolutePath value="${REMOTE_HOME}/JDL"/> <!--CHANGE ME-->
                        </JDLFilePath>
                        <JDLRemoteFilePath>
                            <absolutePath value="${REMOTE_HOME}/JDL"/> <!--CHANGE ME-->
                        </JDLRemoteFilePath>
                        <inputSandbox>
							${PROACTIVE_HOME}/lib/ganymed-ssh2-build210.jar
                            ${PROACTIVE_HOME}/lib/classes.jar                  
                            ${PROACTIVE_HOME}/lib/log4j.jar
                            ${PROACTIVE_HOME}/lib/xercesImpl.jar
                            ${PROACTIVE_HOME}/lib/fractal.jar
                            ${PROACTIVE_HOME}/lib/bouncycastle.jar
                            ${PROACTIVE_HOME}/lib/servlet-api.jar   
                            ${PROACTIVE_HOME}/lib/glite-wms-jdlj.jar
                            ${PROACTIVE_HOME}/lib/classad.jar
                            ${PROACTIVE_HOME}/scripts/proactive.java.policy
                            ${PROACTIVE_HOME}/scripts/proactive-log4j
						    ${PROACTIVE_HOME}/scripts/unix/cluster/gLiteStartRuntime.sh
                            <!--complete with your classes and input files -->
						</inputSandbox>
                        <outputSandbox>error.log stdout.log</outputSandbox>
                    </gLiteOptions>
                </gLiteProcess>
            </processDefinition>

 
			<processDefinition id="sshHierarchical">
                <hierarchicalProcess class="org.objectweb.proactive.core.process.ssh.SSHHierarchicalProcess" hostname="lx2.lal.in2p3.fr" username="emathias">
                    <processReference refid="uiJVM"/>
                    <hierarchicalReference refid = "gLiteProcess"/>
                </hierarchicalProcess>
            </processDefinition>
        </processes>
    </infrastructure>
</ProActiveDescriptor>

